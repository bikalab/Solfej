!function(){var t=["AENC","APIC","COMM","COMR","ENCR","EQUA","ETCO","GEOB","GRID","IPLS","LINK","MCDI","MLLT","OWNE","PRIV","PCNT","POPM","POSS","RBUF","RVAD","RVRB","SYLT","SYTC","TALB","TBPM","TCOM","TCON","TCOP","TDAT","TDLY","TENC","TEXT","TFLT","TIME","TIT1","TIT2","TIT3","TKEY","TLAN","TLEN","TMED","TOAL","TOFN","TOLY","TOPE","TORY","TOWN","TPE1","TPE2","TPE3","TPE4","TPOS","TPUB","TRCK","TRDA","TRSN","TRSO","TSIZ","TSRC","TSSE","TYER","TXXX","UFID","USER","USLT","WCOM","WCOP","WOAF","WOAR","WOAS","WORS","WPAY","WPUB","WXXX","CNT","BUF","COM","CRA","CRM","ETC","EQU","GEO","IPL","LNK","MCI","MLL","PIC","POP","REV","RVA","SLT","STC","TAL","TBP","TCM","TCO","TCR","TDA","TDY","TEN","TFT","TIM","TKE","TLA","TLE","TMT","TOA","TOF","TOL","TOR","TOT","TP1","TP2","TP3","TP4","TPA","TPB","TRC","TRD","TRK","TSI","TSS","TT1","TT2","TT3","TXT","TXX","TYE","UFI","ULT","WAF","WAR","WAS","WCM","WCP","WPB","WXX"],e=function(e,n,i){Date.now();var r=new FileReader;r.onload=function(n){var r,a,o=n.target.result,T=new Uint8Array(o),l=String.fromCharCode.apply(null,T.slice(0,4)),u=l.slice(0,-1);t.indexOf(l)>-1?(r=T.slice(4,8),a=new Uint32Array(r.reverse().buffer)[0],i({tag:l,size:a,position:e+10})):t.indexOf(u)>-1?(a=65536*(r=T.slice(3,6))[0]+256*r[1]+r[2],i({tag:u,size:a,position:e+6})):i({nothing:1})},r.readAsArrayBuffer(n.slice(e,e+10))},n={picture:function(t,e,n){var i=e.position,r=e.size,a=new FileReader;a.onload=function(e){for(var a=e.target.result,o=new Uint8Array(a),T=1;0!==o[T];T++);var l=String.fromCharCode.apply(null,o.slice(1,T));for(0===o[T]&&T++;0!==o[T];T++);for(;0===o[T];T++);n({blob:new Blob([t.slice(i+T,i+r)],{type:l})})},a.readAsArrayBuffer(t.slice(i,i+64))},txt:function(t,e,n,i){n<1&&i({text:null});var r=new FileReader;r.onload=function(t){var e,n=t.target.result,r=new Uint8Array(n);e=r[0]%3!=0?new Uint16Array(n.slice(1)):r.slice(1),i({text:String.fromCharCode.apply(null,e).replace("\0","")})},r.readAsArrayBuffer(t.slice(e,e+n))},album:function(t,e,n){return this.txt(t,e.position,e.size,n)},artist:function(t,e,n){return this.txt(t,e.position,e.size,n)},title:function(t,e,n){return this.txt(t,e.position,e.size,n)},year:function(t,e,n){return this.txt(t,e.position,e.size,n)},track:function(t,e,n){return this.txt(t,e.position,e.size,n)},genre:function(t,e,n){this.txt(t,e.position,e.size,function(t){var e=t.text,i=e.match(/\(([0-9]+)\)/),r=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock"];n(i?{text:r[i[1]-0]}:{text:e})})}},i=function(t,n){var i=new FileReader;i.onload=function(i){var r=i.target.result,a=new Uint8Array(r);if("ID3"!==String.fromCharCode.apply(null,a.slice(0,3)))return n([]);var o=function(i,r){null==r&&(r=[]),e(i,t,function(t){t.nothing?n(r):(r.push(t),o(t.position+t.size,r))})};o(10)},i.readAsArrayBuffer(t.slice(0,10))},r=function(t,e,r){null!==e&&void 0!==e||(e={});var a={album:!!e.album,artist:!!e.artist,picture:!!e.picture,title:!!e.title,year:!!e.year,track:!!e.track,genre:!!e.genre},o={TALB:"album",TAL:"album",PIC:"picture",APIC:"picture",TP1:"artist",TPE1:"artist",TIT2:"title",TT2:"title",TYER:"year",TYE:"year",TDRC:"year",TRCK:"track",TRK:"track",TCON:"genre",TCO:"genre"};i(t,function(e){var i={},T=e.filter(function(t){var e=o[t.tag];return!!e&&a[e]});T.forEach(function(e,a){var l=o[e.tag];i[l]=null,n[l](t,e,function(t){i[l]=t,a===T.length-1&&r(i)})})})},a=function(t,e){return this.file=t,this.options=e,this};a.prototype={readSync:function(){console.info("FID3.readSync not implemented yet")},read:function(t){r(this.file,this.options,t)}},window.FID3=a}();